---
const links = [
  { href: "/", label: "Home", icon: "ğŸ " },
  { href: "/about", label: "About", icon: "â„¹ï¸" },
  { href: "/posts", label: "Posts", icon: "ğŸ“" },
  { href: "/ethos", label: "Ethos", icon: "ğŸ’¡" },
  { href: "/write-for-us", label: "Write for Us", icon: "âœï¸" }
];

const currentPath = Astro.url.pathname;
---

<nav class="glass-card animate-slide-left" style="display:flex; align-items:center; justify-content:space-between; padding:0.9rem 1.2rem; position:sticky; top:1rem; z-index:100; margin-bottom:1rem;">
  <div style="display:flex; align-items:center; gap:0.75rem;">
    <div class="logo-container" style="position:relative;">
      <div class="logo-glow" style="width:32px; height:32px; border-radius:999px; background:linear-gradient(135deg, #c026d3, #8b5cf6, #06b6d4); box-shadow:0 0 20px rgba(192, 38, 211, 0.6);"></div>
      <div class="logo-ring" style="position:absolute; inset:-3px; border:2px solid transparent; border-radius:999px; background:linear-gradient(135deg, #c026d3, #06b6d4) border-box; -webkit-mask:linear-gradient(#fff 0 0) padding-box, linear-gradient(#fff 0 0); mask:linear-gradient(#fff 0 0) padding-box, linear-gradient(#fff 0 0); -webkit-mask-composite:xor; mask-composite:exclude; opacity:0.5;"></div>
    </div>
    <div>
      <div style="font-weight:700; font-size:1rem; letter-spacing:-0.02em;" class="gradient-text">Neural Hive</div>
      <div style="font-size:0.7rem; color:var(--muted); font-weight:500; letter-spacing:0.05em;">ML MONDAYS</div>
    </div>
  </div>
  
  <div style="display:flex; gap:0.5rem; align-items:center; font-size:0.85rem; flex-wrap:wrap;">
    {links.map((link, index) => (
      <a 
        href={link.href} 
        class={`nav-link ${currentPath === link.href ? 'active' : ''}`}
        style={`padding:0.5rem 1rem; border-radius:12px; border:1px solid transparent; display:flex; align-items:center; gap:0.4rem; font-weight:500; animation-delay:${0.1 * (index + 2)}s;`}
        aria-label={link.label}
      >
        <span style="font-size:1rem;">{link.icon}</span>
        <span class="nav-text">{link.label}</span>
      </a>
    ))}
    
    <div style="width:1px; height:24px; background:var(--border); margin:0 0.25rem;"></div>
    
    <button 
      id="theme-toggle" 
      class="theme-toggle"
      aria-label="Toggle theme"
      type="button"
      style="animation-delay:0.8s;"
    >
      <div class="theme-toggle-slider">
        <span class="theme-toggle-icon">ğŸŒ™</span>
      </div>
    </button>
  </div>
</nav>

<script>
  // Theme toggle functionality
  function initTheme() {
    const themeToggle = document.getElementById('theme-toggle');
    const html = document.documentElement;
    const themeIcon = document.querySelector('.theme-toggle-icon');
    
    // Check for saved theme preference or default to 'dark'
    const currentTheme = localStorage.getItem('theme') || 'dark';
    html.setAttribute('data-theme', currentTheme);
    updateIcon(currentTheme);
    
    themeToggle?.addEventListener('click', () => {
      const currentTheme = html.getAttribute('data-theme');
      const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
      
      // Add transition class
      html.style.transition = 'all 0.4s cubic-bezier(0.4, 0, 0.2, 1)';
      
      html.setAttribute('data-theme', newTheme);
      localStorage.setItem('theme', newTheme);
      updateIcon(newTheme);
      
      // Create ripple effect
      createRipple(themeToggle);
    });
    
    function updateIcon(theme) {
      if (themeIcon) {
        themeIcon.textContent = theme === 'dark' ? 'ğŸŒ™' : 'â˜€ï¸';
      }
    }
    
    function createRipple(button) {
      const ripple = document.createElement('span');
      ripple.style.cssText = `
        position: absolute;
        border-radius: 50%;
        background: rgba(192, 38, 211, 0.5);
        width: 10px;
        height: 10px;
        animation: ripple 0.6s ease-out;
        pointer-events: none;
      `;
      button.appendChild(ripple);
      setTimeout(() => ripple.remove(), 600);
    }
  }
  
  // Initialize on load
  initTheme();
  
  // Reinitialize on navigation (for Astro view transitions)
  document.addEventListener('astro:page-load', initTheme);
</script>

<style>
  @keyframes ripple {
    to {
      width: 100px;
      height: 100px;
      opacity: 0;
    }
  }
  
  .nav-link {
    opacity: 0;
    animation: fadeIn 0.6s cubic-bezier(0.4, 0, 0.2, 1) forwards;
  }
  
  .nav-link.active {
    background: linear-gradient(135deg, rgba(192, 38, 211, 0.15), rgba(139, 92, 246, 0.15));
    border-color: var(--border-hover) !important;
    color: var(--accent-primary);
  }
  
  .nav-link.active::before {
    width: 80%;
  }
  
  .logo-container {
    animation: float 3s ease-in-out infinite;
  }
  
  @media (max-width: 968px) {
    .nav-text {
      display: none;
    }
    
    nav {
      padding: 0.75rem 1rem;
    }
    
    nav > div:last-child {
      gap: 0.3rem;
    }
    
    .nav-link {
      padding: 0.5rem 0.6rem !important;
    }
  }
  
  @media (max-width: 640px) {
    nav {
      flex-direction: column;
      gap: 1rem;
      padding: 1rem;
    }
    
    nav > div:last-child {
      justify-content: center;
      width: 100%;
    }
    
    .nav-text {
      display: inline;
    }
  }
</style>